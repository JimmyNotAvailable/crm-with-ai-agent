<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Workspace - Unified Inbox & AI Copilot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- 1. BI·∫æN & C·∫§U H√åNH CHUNG --- */
        :root {
            /* Light Mode */
            --bg-body: #f4f5f7;
            --bg-panel: #ffffff;
            --bg-hover: #ebecf0;
            --border-color: #dfe1e6;
            --text-main: #172b4d;
            --text-sub: #5e6c84;
            --primary-color: #0052cc;
            --accent-red: #de350b; /* High Priority / Negative */
            --accent-yellow: #ffab00; /* Medium Priority */
            --accent-green: #36b37e; /* Low Priority / Positive */
            --msg-bg-user: #e9f2ff;
            --msg-bg-agent: #ffffff;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --bg-body: #121212;
            --bg-panel: #1e1e1e;
            --bg-hover: #2c2c2c;
            --border-color: #333;
            --text-main: #e0e0e0;
            --text-sub: #a0a0a0;
            --msg-bg-user: #0d2847;
            --msg-bg-agent: #2c2c2c;
            --shadow: 0 1px 3px rgba(0,0,0,0.5);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; height: 100vh; background: var(--bg-body); color: var(--text-main); overflow: hidden; }

        /* --- LAYOUT CH√çNH (3 C·ªòT) --- */
        .workspace-container { display: flex; height: 100vh; width: 100vw; }

        /* --- C·ªòT 1: QUEUE LIST (20%) --- */
        .col-queue { width: 20%; background: var(--bg-panel); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; }
        
        .queue-header { padding: 15px; border-bottom: 1px solid var(--border-color); }
        .queue-tabs { display: flex; gap: 10px; margin-top: 10px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .tab-btn { background: none; border: none; font-size: 13px; color: var(--text-sub); font-weight: 600; white-space: nowrap; cursor: pointer; padding: 4px 8px; border-radius: 4px; }
        .tab-btn.active { background: #e9f2ff; color: var(--primary-color); }

        .ticket-list { flex: 1; overflow-y: auto; }
        .ticket-card { padding: 12px 15px; border-bottom: 1px solid var(--border-color); cursor: pointer; transition: 0.2s; position: relative; }
        .ticket-card:hover { background: var(--bg-hover); }
        .ticket-card.active { background: #ebecf0; border-left: 4px solid var(--primary-color); }
        
        /* Visual Hierarchy: Priority Indicators */
        .ticket-card.high-priority { border-left: 4px solid var(--accent-red); background: rgba(222, 53, 11, 0.05); }
        .ticket-card.medium-priority { border-left: 4px solid var(--accent-yellow); }

        .t-header { display: flex; justify-content: space-between; font-size: 12px; color: var(--text-sub); margin-bottom: 4px; }
        .t-source i { margin-right: 5px; }
        .t-name { font-weight: 700; font-size: 14px; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; }
        .t-preview { font-size: 13px; color: var(--text-sub); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 8px; }
        
        /* AI Tags */
        .ai-tags { display: flex; gap: 5px; flex-wrap: wrap; }
        .tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; font-weight: 600; text-transform: uppercase; }
        .tag-topic { background: #eee; color: #555; }
        .tag-sentiment { display: flex; align-items: center; gap: 3px; }
        .sentiment-neg { color: var(--accent-red); }
        .sentiment-pos { color: var(--accent-green); }

        /* --- C·ªòT 2: MAIN CHAT (50%) --- */
        .col-chat { width: 50%; display: flex; flex-direction: column; background: var(--bg-panel); position: relative; }
        
        .chat-header { height: 60px; border-bottom: 1px solid var(--border-color); padding: 0 20px; display: flex; align-items: center; justify-content: space-between; }
        .cust-status { width: 8px; height: 8px; background: var(--accent-green); border-radius: 50%; display: inline-block; margin-left: 5px; }
        .btn-resolve { background: var(--accent-green); color: white; border: none; padding: 8px 16px; border-radius: 4px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 5px; }

        .chat-body { flex: 1; padding: 20px; overflow-y: auto; background: var(--bg-body); display: flex; flex-direction: column; gap: 15px; }
        
        .system-note { text-align: center; font-size: 12px; color: var(--text-sub); margin: 10px 0; font-style: italic; }
        .system-note span { background: rgba(0,0,0,0.05); padding: 4px 12px; border-radius: 12px; }

        .msg-row { display: flex; gap: 10px; max-width: 80%; }
        .msg-row.agent { align-self: flex-end; flex-direction: row-reverse; }
        .msg-bubble { padding: 10px 15px; border-radius: 8px; font-size: 14px; line-height: 1.5; position: relative; box-shadow: var(--shadow); }
        .msg-row.user .msg-bubble { background: var(--msg-bg-agent); border-top-left-radius: 0; }
        .msg-row.agent .msg-bubble { background: var(--msg-bg-user); border-top-right-radius: 0; }
        .msg-meta { font-size: 11px; color: var(--text-sub); margin-top: 4px; text-align: right; }

        /* Smart Input Area */
        .input-area { border-top: 1px solid var(--border-color); padding: 15px 20px; background: var(--bg-panel); position: relative; }
        
        .smart-chips { display: flex; gap: 8px; margin-bottom: 10px; overflow-x: auto; }
        .chip { background: #e9f2ff; color: var(--primary-color); border: 1px solid transparent; padding: 6px 12px; border-radius: 16px; font-size: 12px; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 5px; }
        .chip:hover { background: #d0e2ff; }
        .chip i { font-size: 10px; }
        .chip-hint { font-size: 10px; opacity: 0.6; margin-left: 5px; border: 1px solid currentColor; padding: 0 4px; border-radius: 3px; }

        .editor-container { position: relative; }
        .chat-input { width: 100%; min-height: 80px; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; resize: none; background: var(--bg-body); color: var(--text-main); font-family: inherit; }
        .editor-toolbar { display: flex; justify-content: space-between; margin-top: 5px; align-items: center; }
        .tools i { color: var(--text-sub); margin-right: 15px; cursor: pointer; font-size: 16px; }
        .tools i:hover { color: var(--primary-color); }
        .send-hint { font-size: 11px; color: var(--text-sub); margin-right: 10px; }

        /* --- C·ªòT 3: AI COPILOT (30%) --- */
        .col-ai { width: 30%; background: var(--bg-panel); border-left: 1px solid var(--border-color); display: flex; flex-direction: column; overflow-y: auto; }
        
        .ai-header { padding: 15px; border-bottom: 1px solid var(--border-color); display: flex; align-items: center; gap: 8px; font-weight: 600; color: #4b35ac; }
        
        .ai-card { padding: 15px; border-bottom: 1px solid var(--border-color); }
        .ai-title { font-size: 13px; font-weight: 700; color: var(--text-sub); text-transform: uppercase; margin-bottom: 10px; display: flex; justify-content: space-between; }
        
        /* Module 1: Summary */
        .summary-box { background: linear-gradient(to right bottom, rgba(75, 53, 172, 0.05), rgba(0, 82, 204, 0.05)); padding: 12px; border-radius: 6px; font-size: 13px; line-height: 1.5; border: 1px dashed #b3b3ff; }
        .feedback-actions { display: flex; gap: 10px; margin-top: 8px; }
        .fb-btn { border: none; background: none; color: var(--text-sub); cursor: pointer; font-size: 12px; }
        .fb-btn:hover { color: var(--primary-color); }

        /* Module 2: KB / RAG */
        .kb-item { display: flex; gap: 10px; margin-bottom: 12px; background: var(--bg-body); padding: 10px; border-radius: 6px; }
        .kb-icon { color: var(--primary-color); font-size: 16px; margin-top: 2px; }
        .kb-content h4 { font-size: 13px; margin-bottom: 4px; }
        .kb-content p { font-size: 11px; color: var(--text-sub); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .kb-actions { margin-top: 5px; }
        .kb-btn { font-size: 11px; padding: 4px 8px; border: 1px solid var(--border-color); background: white; border-radius: 4px; cursor: pointer; }
        
        /* Module 3: Customer 360 */
        .cust-360-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .stat-box { background: var(--bg-body); padding: 10px; border-radius: 6px; text-align: center; }
        .stat-label { font-size: 11px; color: var(--text-sub); }
        .stat-val { font-size: 16px; font-weight: 700; color: var(--text-main); margin-top: 4px; }

        /* Dark Mode Toggle */
        .dm-toggle { position: absolute; bottom: 15px; left: 15px; font-size: 20px; cursor: pointer; color: var(--text-sub); }

    </style>
</head>
<body>

    <div class="workspace-container">
        
        <aside class="col-queue">
            <div class="queue-header">
                <h3 style="font-size: 18px;">H·ªôp th∆∞ (12)</h3>
                <div class="queue-tabs">
                    <button class="tab-btn active">C·∫ßn x·ª≠ l√Ω (5)</button>
                    <button class="tab-btn">ƒêang ch·ªù</button>
                    <button class="tab-btn">C·ªßa t√¥i</button>
                </div>
            </div>
            
            <div class="ticket-list">
                <div class="ticket-card high-priority active">
                    <div class="t-header">
                        <span class="t-source"><i class="fa-brands fa-facebook-messenger"></i> Facebook</span>
                        <span>5m ago</span>
                    </div>
                    <div class="t-name">Nguy·ªÖn VƒÉn An <i class="fa-solid fa-face-angry sentiment-neg" title="Gi·∫≠n d·ªØ"></i></div>
                    <div class="t-preview">S·∫£n ph·∫©m b·ªã l·ªói, t√¥i mu·ªën ho√†n ti·ªÅn ngay l·∫≠p t·ª©c...</div>
                    <div class="ai-tags">
                        <span class="tag" style="background:#ffebe6; color:#de350b">High Priority</span>
                        <span class="tag tag-topic">Khi·∫øu n·∫°i</span>
                    </div>
                </div>

                <div class="ticket-card medium-priority">
                    <div class="t-header">
                        <span class="t-source"><i class="fa-solid fa-globe"></i> Website</span>
                        <span>12m ago</span>
                    </div>
                    <div class="t-name">Tr·∫ßn Th·ªã B <i class="fa-solid fa-face-meh" style="color:gray"></i></div>
                    <div class="t-preview">Cho m√¨nh h·ªèi v·ªÅ ch√≠nh s√°ch b·∫£o h√†nh...</div>
                    <div class="ai-tags">
                        <span class="tag" style="background:#fffae6; color:#ff8b00">Medium</span>
                        <span class="tag tag-topic">T∆∞ v·∫•n</span>
                    </div>
                </div>

                 <div class="ticket-card">
                    <div class="t-header">
                        <span class="t-source"><i class="fa-solid fa-phone"></i> Zalo</span>
                        <span>30m ago</span>
                    </div>
                    <div class="t-name">L√™ VƒÉn C <i class="fa-solid fa-face-smile sentiment-pos"></i></div>
                    <div class="t-preview">C·∫£m ∆°n shop ƒë√£ g·ª≠i h√†ng nh√©.</div>
                    <div class="ai-tags">
                        <span class="tag" style="background:#e3fcef; color:#006644">Low</span>
                    </div>
                </div>
            </div>

            <i class="fa-solid fa-moon dm-toggle" onclick="toggleDarkMode()" title="Ch·∫ø ƒë·ªô t·ªëi"></i>
        </aside>

        <main class="col-chat">
            <div class="chat-header">
                <div>
                    <h4 style="margin:0;">Nguy·ªÖn VƒÉn An <span class="cust-status"></span></h4>
                    <span style="font-size:12px; color:var(--text-sub);">Ticket #Ticket-9221 ‚Ä¢ ƒêang g√µ...</span>
                </div>
                <button class="btn-resolve"><i class="fa-solid fa-check"></i> Ho√†n t·∫•t phi·∫øu</button>
            </div>

            <div class="chat-body" id="chatBody">
                <div class="system-note">
                    <span><i class="fa-solid fa-robot"></i> ƒê∆∞·ª£c chuy·ªÉn t·ª´ Chatbot l√∫c 10:30</span>
                </div>
                <div class="system-note">
                    <span><i class="fa-solid fa-triangle-exclamation"></i> AI ƒë√£ g√°n nh√£n: <strong>High Priority</strong> (Kh√°ch gi·∫≠n d·ªØ)</span>
                </div>

                <div class="msg-row user">
                    <div class="msg-bubble">
                        Ch√†o shop, t√¥i m·ªõi nh·∫≠n ƒë∆∞·ª£c ƒë∆°n h√†ng gi√†y Nike h√¥m qua.
                    </div>
                </div>
                <div class="msg-row agent">
                    <div class="msg-bubble">
                        D·∫° ch√†o anh An, em l√† nh√¢n vi√™n h·ªó tr·ª£. Anh cho em xin m√£ ƒë∆°n h√†ng ·∫°?
                    </div>
                </div>
                <div class="msg-row user">
                    <div class="msg-bubble">
                        M√£ l√† #ORD-9988. V·∫•n ƒë·ªÅ l√† ƒë·∫ø gi√†y b·ªã bong keo ch·ªâ sau 1 ng√†y ƒëi th·ª≠. T√¥i r·∫•t th·∫•t v·ªçng! T√¥i mu·ªën ho√†n ti·ªÅn ngay. üò°
                    </div>
                    <span class="msg-meta">10:32 AM</span>
                </div>
            </div>

            <div class="input-area">
                <div class="smart-chips" id="smartChips">
                    <div class="chip" onclick="useSmartReply(this)">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> Xin l·ªói v·ªÅ s·ª± c·ªë <span class="chip-hint">Tab</span>
                    </div>
                    <div class="chip" onclick="useSmartReply(this)">
                        <i class="fa-solid fa-rotate-left"></i> G·ª≠i ch√≠nh s√°ch ƒë·ªïi tr·∫£
                    </div>
                    <div class="chip" onclick="useSmartReply(this)">
                        <i class="fa-solid fa-credit-card"></i> H∆∞·ªõng d·∫´n ho√†n ti·ªÅn
                    </div>
                </div>

                <div class="editor-container">
                    <textarea class="chat-input" id="chatInput" placeholder="Nh·∫≠p tin nh·∫Øn... (Ctrl+Enter ƒë·ªÉ g·ª≠i)"></textarea>
                    <div class="editor-toolbar">
                        <div class="tools">
                            <i class="fa-solid fa-font" title="Format"></i>
                            <i class="fa-solid fa-paperclip" title="Attach"></i>
                            <i class="fa-regular fa-face-smile" title="Emoji"></i>
                            <i class="fa-regular fa-image" title="Image"></i>
                        </div>
                        <div>
                            <span class="send-hint">Ctrl + Enter</span>
                            <button class="btn-resolve" style="display:inline-flex; padding: 6px 15px;" onclick="sendMessage()">G·ª≠i</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <aside class="col-ai">
            <div class="ai-header">
                <i class="fa-solid fa-sparkles"></i> AI Copilot
            </div>

            <div class="ai-card">
                <div class="ai-title">
                    T√≥m t·∫Øt v√© (AI Summary)
                    <i class="fa-solid fa-arrows-rotate" style="cursor:pointer; font-size:11px;" title="L√†m m·ªõi"></i>
                </div>
                <div class="summary-box">
                    Kh√°ch h√†ng ph√†n n√†n v·ªÅ ch·∫•t l∆∞·ª£ng gi√†y (bong keo) m√£ ƒë∆°n #ORD-9988. Kh√°ch y√™u c·∫ßu ho√†n ti·ªÅn thay v√¨ ƒë·ªïi h√†ng. C·∫£m x√∫c hi·ªán t·∫°i r·∫•t ti√™u c·ª±c.
                </div>
                <div class="feedback-actions">
                    <button class="fb-btn"><i class="fa-regular fa-thumbs-up"></i> H·ªØu √≠ch</button>
                    <button class="fb-btn"><i class="fa-regular fa-pen-to-square"></i> Ch·ªânh s·ª≠a</button>
                </div>
            </div>

            <div class="ai-card">
                <div class="ai-title">Ki·∫øn th·ª©c ƒë·ªÅ xu·∫•t (RAG)</div>
                
                <div class="kb-item">
                    <div class="kb-icon"><i class="fa-solid fa-book-open"></i></div>
                    <div class="kb-content">
                        <h4>Ch√≠nh s√°ch Ho√†n ti·ªÅn 2024</h4>
                        <p>√Åp d·ª•ng cho s·∫£n ph·∫©m l·ªói s·∫£n xu·∫•t. Ho√†n ti·ªÅn 100% trong 24h qua v√≠ ƒëi·ªán t·ª≠...</p>
                        <div class="kb-actions">
                            <button class="kb-btn" onclick="pasteToChat('Ch√≠nh s√°ch Ho√†n ti·ªÅn 2024: √Åp d·ª•ng cho l·ªói s·∫£n xu·∫•t, ho√†n 100% trong 24h.')">G·ª≠i ngay</button>
                            <button class="kb-btn">Xem chi ti·∫øt</button>
                        </div>
                    </div>
                </div>

                <div class="kb-item">
                    <div class="kb-icon"><i class="fa-solid fa-shoe-prints"></i></div>
                    <div class="kb-content">
                        <h4>Quy tr√¨nh ki·ªÉm ƒë·ªãnh l·ªói gi√†y</h4>
                        <p>H∆∞·ªõng d·∫´n kh√°ch ch·ª•p ·∫£nh ƒë·∫ø gi√†y, tem gi√†y v√† h·ªôp s·∫£n ph·∫©m...</p>
                        <div class="kb-actions">
                             <button class="kb-btn" onclick="pasteToChat('B·∫°n vui l√≤ng ch·ª•p ·∫£nh r√µ ƒë·∫ø gi√†y v√† tem gi√∫p m√¨nh nh√©.')">G·ª≠i ngay</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="ai-card">
                <div class="ai-title">H·ªì s∆° kh√°ch h√†ng</div>
                <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
                    <div style="width:40px; height:40px; background:#ddd; border-radius:50%;"></div>
                    <div>
                        <div style="font-weight:700; font-size:14px;">Nguy·ªÖn VƒÉn An</div>
                        <div style="font-size:11px; color:#d93025; font-weight:bold;">VIP Gold Member</div>
                    </div>
                </div>
                <div class="cust-360-grid">
                    <div class="stat-box">
                        <div class="stat-label">T·ªïng chi ti√™u</div>
                        <div class="stat-val">15.2M</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">LTV</div>
                        <div class="stat-val">Cao</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">ƒê∆°n h√†ng</div>
                        <div class="stat-val">12</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">CSKH</div>
                        <div class="stat-val">1 khi·∫øu n·∫°i</div>
                    </div>
                </div>
            </div>

        </aside>
    </div>

    <script>
        // --- JAVASCRIPT LOGIC ---
        
        const chatInput = document.getElementById('chatInput');
        const chatBody = document.getElementById('chatBody');
        const smartChips = document.getElementById('smartChips');

        // 1. X·ª≠ l√Ω Smart Reply (Chips)
        function useSmartReply(element) {
            // L·∫•y text t·ª´ chip (b·ªè icon v√† hint)
            const text = element.childNodes[2].textContent.trim(); 
            chatInput.value = text + " ";
            chatInput.focus();
            
            // ·∫®n chips sau khi ch·ªçn (gi·∫£ l·∫≠p UX)
            // element.style.display = 'none';
        }

        // 2. Paste n·ªôi dung t·ª´ KB v√†o chat
        function pasteToChat(text) {
            chatInput.value = text;
            chatInput.focus();
        }

        // 3. X·ª≠ l√Ω ph√≠m t·∫Øt
        chatInput.addEventListener('keydown', function(e) {
            // Tab: Ch·ªçn chip ƒë·∫ßu ti√™n
            if (e.key === 'Tab' && !e.shiftKey) {
                e.preventDefault();
                const firstChip = smartChips.querySelector('.chip');
                if (firstChip) useSmartReply(firstChip);
            }
            
            // Ctrl + Enter: G·ª≠i tin nh·∫Øn
            if (e.ctrlKey && e.key === 'Enter') {
                sendMessage();
            }
        });

        // 4. G·ª≠i tin nh·∫Øn
        function sendMessage() {
            const text = chatInput.value.trim();
            if (!text) return;

            // Add Agent Message
            const msgRow = document.createElement('div');
            msgRow.className = 'msg-row agent';
            msgRow.innerHTML = `
                <div class="msg-bubble">${text}</div>
            `;
            chatBody.appendChild(msgRow);
            
            // Clear input & Scroll
            chatInput.value = '';
            chatBody.scrollTop = chatBody.scrollHeight;

            // Mock: G·ª° b·ªè nh√£n High Priority sau khi rep (Demo logic)
            setTimeout(() => {
                console.log("System: Updated ticket status");
            }, 1000);
        }

        // 5. Dark Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        // Initial Scroll to bottom
        chatBody.scrollTop = chatBody.scrollHeight;

    </script>
</body>
</html>